<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Window functions (part3) - new functions</title>
  <meta name="description" content="In the&nbsp;first&nbsp;and the&nbsp;second&nbsp;part of window function series, I talked about the OVER clause, with/without partitions and with/without orde...">

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic|Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/bootstrap-social.css">
  <link rel="canonical" href="https://asfernandes.github.io/2010/02/19/window-functions-part3-new-functions.html">
  <link rel="alternate" type="application/rss+xml" title="asfernandes' blog" href="https://asfernandes.github.io/feed.xml">

  

  
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-7263221-3', 'auto');
		ga('send', 'pageview');
	</script>
	<!-- End Google Analytics -->


</head>


	<!-- Start of StatCounter Code for Default Guide -->
	<script type="text/javascript">
	var sc_project=11098306;
	var sc_invisible=1;
	var sc_security="a73f5966";
	var scJsHost = (("https:" == document.location.protocol) ?
	"https://secure." : "http://www.");
	document.write("<sc"+"ript type='text/javascript' src='" +
	scJsHost+
	"statcounter.com/counter/counter.js'></"+"script>");
	</script>
	<noscript><div class="statcounter"><a title="shopify stats"
	href="http://statcounter.com/shopify/" target="_blank"><img
	class="statcounter"
	src="//c.statcounter.com/11098306/0/a73f5966/1/"
	alt="shopify stats"></a></div></noscript>
	<!-- End of StatCounter Code for Default Guide -->



  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://asfernandes.github.io">asfernandes' blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        <li>
          <a href="/contact">contact</a>
        </li>
      

      
        <li>
          <a href="/search" class="nav-search-link" title="Search">
            <span class="fa fa-search nav-search-icon"></span>
            <span class="nav-search-text"></span>
          </a>
        </li>
        
      </ul>
    </div>

  
  <div class="avatar-container">
    <div class="avatar-img-border">
      <a href="https://asfernandes.github.io">
        <img class="avatar-img" src="/img/avatar-icon.png" alt="asfernandes' blog"/>
    </a>
    </div>
  </div>
  

  </div>
</nav>

    <div role="main" class="container main-content">
        <header class="header-post">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <div class="post-heading">
        <h1>Window functions (part3) - new functions</h1>
        
        <span class="post-meta">Posted on February 19, 2010 in
        
          
          
          <a href="/tag/firebird" class="blog-tags">firebird</a>
        
        </span>
      </div>
     </div>
  </div>
</header>

<article>
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
	    In the&nbsp;<a href="http://asfernandes.blogspot.com/2010/01/window-functions_19.html" id="odpv" title="first">first</a>&nbsp;and the&nbsp;<a href="http://asfernandes.blogspot.com/2010/01/window-functions-part2-cumulative_24.html" id="wif4" style="color:#551a8b" title="second">second</a>&nbsp;part of window function series, I talked about the <font face="&#39;Courier New&#39;">OVER</font> clause, with/without partitions and with/without ordering. Till then, no new function had been introduced, so it has about the already existing aggregate functions.<br><br><div>Now, new window-only functions has been introduced. I&#39;ll separate them in two groups: ranking and navigational. Both set of functions can be used with/without partition/ordering, but them does not make much sense without ordering.</div><br><div><b>Ranking functions (DENSE_RANK, RANK and ROW_NUMBER):</b>&nbsp;with these functions, one can create different type of incremental counters. Think about <font face="&#39;Courier New&#39;">SUM(1) OVER (ORDER BY SALARY)</font>, these functions does this type of thing, but all of them in different ways. Lets see an example query, also comparing with the SUM behavior.</div><br><div><font face="&#39;courier new&#39;">select<br></font><font face="&#39;courier new&#39;">&nbsp;&nbsp; &nbsp;id,</font></div><div><font face="&#39;courier new&#39;">&nbsp;&nbsp; &nbsp;salary,</font></div><div><font face="&#39;courier new&#39;"><font face="&#39;courier new&#39;"><font face="&#39;courier new&#39;">&nbsp;&nbsp; &nbsp;dense_rank() over (order by salary),<br></font><font face="&#39;courier new&#39;">&nbsp;&nbsp; &nbsp;rank() over (order by salary),<br></font>&nbsp;&nbsp; &nbsp;row_number() over (order by salary),<br></font>&nbsp;&nbsp; &nbsp;sum(1) over (order by salary)<br></font><font face="&#39;courier new&#39;">&nbsp;&nbsp;from employee</font><br><div><font face="&#39;Courier New&#39;">&nbsp;&nbsp;order by salary;</font></div><br></div>And the result set:<br><br><table border="1" bordercolor="#000000" cellpadding="3" cellspacing="0" id="ae:0"><tbody><tr style="text-align:left"><td style="text-align:right" width="16.666666666666668%"><font size="2">id</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">salary</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">dense_rank</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">rank</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">row_number</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">sum</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="16.666666666666668%"><font size="2">3</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">8.00</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">1</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">1</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">1</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">1</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="16.666666666666668%"><font size="2">4</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">9.00</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">2</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">2</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">2</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">2</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="16.666666666666668%"><font size="2">1</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">10.00</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">3</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">3</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">3</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">4</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="16.666666666666668%"><font size="2">5</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">10.00</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">3</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">3</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">4</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">4</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="16.666666666666668%"><font size="2">2</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">12.00</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">4</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">5</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">5</font></td><td style="text-align:right" width="16.666666666666668%"><font size="2">5</font></td></tr></tbody></table><br>As you see, the functions differs when repeated values are found in the order key (the salary of 10.00). With DENSE_RANK, no gaps are created and all repeated values receive the same counter. With RANK, the initial counter is used for all repeated values, but it make gaps so the next non-repeating value (the salary of 12.00) does not consider the previously repeated values as in different positions. With ROW_NUMBER, each line receives an incremental value. And SUM(1) is very like RANK, but the value is computed after all repeated values are summed, so the gap is before the repeated values.<br><br><div><b>Navigational functions (LAG and LEAD):</b>&nbsp;with these functions, an expression could get the value of a previously (LAG) or a posterior (LEAD) row of the query. Follow the demonstrating query.</div><br><div><div>select</div><div>&nbsp;&nbsp; &nbsp;id,</div><div>&nbsp;&nbsp; &nbsp;salary,</div><div>&nbsp;&nbsp; &nbsp;lag(salary) over (order by salary),</div><div>&nbsp;&nbsp; &nbsp;lead(salary) over (order by salary)</div><div>&nbsp;&nbsp;from employee</div><div>&nbsp;&nbsp;order by salary;</div><br>And the result set:</div><br><table border="1" bordercolor="#000000" cellpadding="3" cellspacing="0" id="l7bi"><tbody><tr style="text-align:left"><td style="text-align:right" width="25%"><font size="2">id</font></td><td style="text-align:right" width="25%"><font size="2">salary</font></td><td style="text-align:right" width="25%"><font size="2">lag</font></td><td style="text-align:right" width="25%"><font size="2">lead</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="25%"><font size="2">3</font></td><td style="text-align:right" width="25%"><font size="2">8.00</font></td><td style="text-align:right" width="25%"><font size="2">&lt;null&gt;</font></td><td style="text-align:right" width="25%"><font size="2">9.00</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="25%"><font size="2">4</font></td><td style="text-align:right" width="25%"><font size="2">9.00</font></td><td style="text-align:right" width="25%"><font size="2">8.00</font></td><td style="text-align:right" width="25%"><font size="2">10.00</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="25%"><font size="2">1</font></td><td style="text-align:right" width="25%"><font size="2">10.00</font></td><td style="text-align:right" width="25%"><font size="2">9.00</font></td><td style="text-align:right" width="25%"><font size="2">10.00</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="25%"><font size="2">5</font></td><td style="text-align:right" width="25%"><font size="2">10.00</font></td><td style="text-align:right" width="25%"><font size="2">10.00</font></td><td style="text-align:right" width="25%"><font size="2">12.00</font></td></tr><tr style="text-align:left"><td style="text-align:right" width="25%"><font size="2">2</font></td><td style="text-align:right" width="25%"><font size="2">12.00</font></td><td style="text-align:right" width="25%"><font size="2">10.00</font></td><td style="text-align:right" width="25%"><font size="2">&lt;null&gt;</font></td></tr></tbody></table><br>The functions have a second argument, that is implicitly 1, which means the number of previously/posterior rows will be queried. If this row does not exist, &lt;null&gt; is returned.<br><br><div>And of course, you can use these functions as expressions and compute, for example, the difference of an employee salary from the one greater and/or lesser.<br></div><br>
	  </div>
  </div>
</article>

<div class="row">
  <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

    
      <!-- Check if any share-links are active -->




<section id = "social-share-section">

  <!--- Share on Twitter -->
  
    <a href="https://twitter.com/intent/tweet?text=https://asfernandes.github.io/2010/02/19/window-functions-part3-new-functions.html&via=adrianosf"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter"
      data-ga-event=1 data-ga-category="share" data-ga-action="social-twitter" data-ga-label="/2010/02/19/window-functions-part3-new-functions.html">
      <span class="fa fa-fw fa-twitter" aria-hidden="true"></span>
    </a>
  

  <!--- Share on Facebook -->
  
    <a href="https://www.facebook.com/sharer/sharer.php?u=https://asfernandes.github.io/2010/02/19/window-functions-part3-new-functions.html"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook"
      data-ga-event=1 data-ga-category="share" data-ga-action="social-facebook" data-ga-label="/2010/02/19/window-functions-part3-new-functions.html">
      <span class="fa fa-fw fa-facebook" aria-hidden="true"></span>
    </a>
  

  <!--- Share on Google Plus -->
  
    <a href="https://plus.google.com/share?url=https://asfernandes.github.io/2010/02/19/window-functions-part3-new-functions.html"
      class="btn btn-social-icon btn-google" title="Share on Google+"
      data-ga-event=1 data-ga-category="share" data-ga-action="social-google" data-ga-label="/2010/02/19/window-functions-part3-new-functions.html">
      <span class="fa fa-fw fa-google-plus" aria-hidden="true"></span>
    </a>
  

  <!--- Share on LinkedIn -->
  
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://asfernandes.github.io/2010/02/19/window-functions-part3-new-functions.html"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn"
      data-ga-event=1 data-ga-category="share" data-ga-action="social-linkedin" data-ga-label="/2010/02/19/window-functions-part3-new-functions.html">
      <span class="fa fa-fw fa-linkedin" aria-hidden="true"></span>
    </a>
  

</section>



    

    <ul class="pager blog-pager">
      
      <li class="previous">
        <a href="/2010/02/13/firebird-history-in-9-minutes-video.html" data-toggle="tooltip" data-placement="top" title="Firebird History in 9 minutes video">&larr; Previous Post</a>
      </li>
      
      
      <li class="next">
        <a href="/2010/07/31/firebird-10th-anniversary-how-i-came-to.html" data-toggle="tooltip" data-placement="top" title="Firebird 10th anniversary. How I came to it.">Next Post &rarr;</a>
      </li>
      
    </ul>
  </div>
</div>


<div class="row disqus-comments">
  <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
	    var disqus_shortname = 'asfernandes-blog';
	    // ensure that pages with query string get the same discussion
            var url_parts = window.location.href.split("?");
            var disqus_url = url_parts[0];	    
	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


  </div>
</div>


    </div>
    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="https://github.com/asfernandes" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
      
          <li>
            <a href="https://twitter.com/adrianosf" title="Twitter">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
      
          <li>
            <a href="mailto:adrianosf@gmail.com" title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
      
          <li>
            <a href="https://linkedin.com/in/adrianosf" title="LinkedIn">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
      
      
      <li>
      <a href="/feed.xml" title="RSS">
        <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
        </span>
      </a>
      </li>   
               
        </ul>
        <p class="copyright text-muted">
      Adriano dos Santos Fernandes
      &nbsp;&bull;&nbsp;
      2017
      
      
      </p>
          <!-- Please don't remove this, keep my open source work credited :) -->
    <p class="theme-by text-muted">
      Theme by
      <a href="http://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
    </p>
      </div>
    </div>
  </div>
</footer>
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
    







    
  </body>
</html>
